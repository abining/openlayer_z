<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>test14</title>
    <script src="./package/dist/ol.js"></script>
    <link rel="stylesheet" type="text/css" href="./package/ol.css" />

    <script src="./js/mapUtils.js"></script>
    <script src="./js/init14.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/style.css" />
    <link rel="stylesheet" type="text/css" href="./css/map10.css" />
  </head>

  <body>
    <div id="map">
      <div id="layControl" class="layControl">
        <div class="title"><label>图层列表</label></div>
        <!-- 这是一个无序列表，用于展示图层控制列表 -->
        <ul id="layerTree" class="layerTree"></ul>
      </div>
      <div id="mouse-position"></div>
    </div>

    <script>
      var map = mapinit("map", 120, 30, 9);

      // 实例化自定义的缩放控件，传入lebel，并且添加到地图中
      map.addControl(
        new ol.control.Zoom({
          zoomInTipLabel: "放大",
          zoomOutTipLabel: "缩小",
        })
      );
      //加入鹰眼效果
      var overviewMap = new ol.control.OverviewMap({
        collapsed: false,
        layers: [
          new ol.layer.Tile({
            source: new ol.source.XYZ({
              ur1: "http://t0.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=2a16e0c0544e2cbee46965bee22b1f0c",
              wrapX: false,
            }),
          }),
          new ol.layer.Tile({
            source: new ol.source.XYZ({
              url: "http://t0.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=2a16e0c0544e2cbee46965bee22b1f0c",
              wrapX: false,
            }),
          }),
        ],
      });
      map.addControl(overviewMap);

      var layers = map.getLayers();
      console.log(layers, "layers");

      //添加新的图层,wmts

      var matrixSet = "EPSG:4326";
      var format = "image/png";
      var tileSize = [256, 256];
      var extent = [-180.0, -90.0, 180.0, 90.0];
      var origin = [-180.0, 90.0];

      var matrixIds = ['EPSG:4326:0','EPSG:4326:1','EPSG:4326:2','EPSG:4326:3','EPSG:4326:4','EPSG:4326:5',
		'EPSG:4326:6','EPSG:4326:7','EPSG:4326:8','EPSG:4326:9','EPSG:4326:10',,'EPSG:4326:11','EPSG:4326:12'
		,'EPSG:4326:13','EPSG:4326:14','EPSG:4326:15','EPSG:4326:16','EPSG:4326:17','EPSG:4326:18'
		,'EPSG:4326:19','EPSG:4326:20','EPSG:4326:21'];

      var resolutions = [
        0.703125, 0.3515625, 0.17578125, 0.087890625, 0.0439453125,
        0.02197265625, 0.010986328125, 0.0054931640625, 0.00274658203125,
        0.001373291015625, 0.0006866455078125, 0.0003433227539062,
        0.0001716613769531, 0.0000858306884766, 0.0000429153442383,
        0.0000214576721191, 0.0000107288360596, 0.0000053644180298,
        0.0000026822090149, 0.0000013411045074, 0.0000006705522537,
        0.0000003352761269,
      ];

      var wmtssource = new ol.source.WMTS({
        url: "http://localhost:8080/geoserver/gwc/service/wmts",
        layer: "webgis:webgis-roads",
        matrixSet: matrixSet,
        format: format,
        tileGrid: new ol.tilegrid.WMTS({
          tileSize: tileSize,
          extent: extent,
          origin: origin,
          matrixIds: matrixIds,
          resolutions: resolutions,
        }),
      });
	  // 实例化
      var wmtsLayer = new ol.layer.Tile({
        title: "WMTS 道路图层", // 图层名称的title
        source: wmtssource,
      });

      // map是已经初始化的地图实例
      map.addLayer(wmtsLayer);

      loadLayerControl(map, "layerTree");
    </script>
  </body>
</html>
